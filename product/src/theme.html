<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ÊäΩÁçéÁ≥ªÁµ±‰∏ªÈ°åËâ≤ÂΩ©Á∑®ËºØÂô®</title>
  <style>
    body {
      font-family: Arial, sans-serif; 
      background: linear-gradient(135deg, #131313 0%, #02101c 100%);
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    h1 { 
      font-size: 2em; 
      margin-bottom: 1em; 
      text-align: center;
      color: #0ff;
      text-shadow: 0 0 10px rgba(0,255,255,0.5);
      transition: opacity 0.3s, transform 0.3s;
      z-index: 1001;
      position: relative;
    }
    .h1-hidden {
      opacity: 0;
      transform: translateY(-40px);
      pointer-events: none;
    }
    .controls {
      text-align: center;
      margin-bottom: 2em;
      position: sticky;
      top: 0;
      background: rgba(19,19,19,0.95);
      z-index: 1000;
      padding: 16px 0 10px 0;
      box-shadow: 0 2px 12px 0 rgba(0,0,0,0.08);
      border-bottom: 1px solid rgba(0,255,255,0.08);
      transition: box-shadow 0.2s;
    }
    .btn {
      background: rgba(0,255,255,0.3);
      color: #fff;
      border: 1px solid rgba(127,255,255,0.5);
      padding: 10px 20px;
      margin: 0 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }
    .btn:hover {
      background: rgba(0,255,255,0.5);
      box-shadow: 0 0 10px rgba(0,255,255,0.3);
    }
    .palette { 
      display: flex;
      flex-wrap: wrap;
      gap: 20px; 
      max-width: 1400px;
      margin: 0 auto;
      justify-content: center;
    }
    .color-item {
      background: rgba(0,127,127,0.2);
      border: 1px solid rgba(127,255,255,0.3);
      border-radius: 10px;
      padding: 15px;
      width: 400px;
      min-height: 120px;
      box-sizing: border-box;
      display: flex;
      flex-direction: row;
      align-items: stretch;
      justify-content: flex-start;
    }
    .color-preview {
      width: 90px;
      height: 90px;
      border-radius: 8px;
      border: 2px solid rgba(255,255,255,0.3);
      margin-right: 18px;
      margin-top: 8px;
      cursor: pointer;
      position: relative;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .color-preview input[type="color"] {
      position: absolute;
      left: 0; top: 0;
      width: 100%; height: 100%;
      opacity: 0;
      cursor: pointer;
      border: none;
      padding: 0;
      margin: 0;
    }
    .color-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .color-label {
      font-size: 15px;
      font-weight: bold;
      margin-bottom: 8px;
      color: rgba(127,255,255,0.9);
      text-align: left;
    }
    .color-controls {
      display: flex;
      flex-direction: column;
      gap: 8px;
      width: 100%;
      align-items: stretch;
    }
    .color-input {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      justify-content: flex-start;
      margin-bottom: 2px;
    }
    .color-input label {
      width: 32px;
      font-size: 13px;
      color: #0ff;
      text-align: right;
      margin-right: 4px;
    }
    .color-input input[type="range"] {
      flex: 1;
      height: 6px;
      background: rgba(255,255,255,0.2);
      border-radius: 3px;
      outline: none;
      max-width: 120px;
    }
    .color-input input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      background: #0ff;
      border-radius: 50%;
      cursor: pointer;
    }
    .color-value {
      font-family: monospace;
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      background: rgba(0,0,0,0.3);
      padding: 4px 8px;
      border-radius: 4px;
      min-width: 120px;
      text-align: center;
      margin-top: 2px;
    }
    .reset-btn {
      background: rgba(253,105,0,0.3);
      color: #fff;
      border: 1px solid rgba(253,105,0,0.5);
      padding: 4px 8px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 11px;
      margin-top: 8px;
      width: 60px;
      align-self: flex-end;
    }
    .reset-btn:hover {
      background: rgba(253,105,0,0.5);
    }
    .status {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0,255,0,0.8);
      color: #000;
      padding: 10px 15px;
      border-radius: 5px;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.3s;
    }
    input[type="color"].hidden-picker {
      display: none;
    }
  </style>
</head>
<body>
  <h1 id="main-title">ÊäΩÁçéÁ≥ªÁµ±‰∏ªÈ°åËâ≤ÂΩ©Á∑®ËºØÂô®</h1>
  
  <div class="controls">
    <button class="btn" onclick="saveTheme()">üíæ ÂÑ≤Â≠ò‰∏ªÈ°å</button>
    <button class="btn" onclick="loadTheme()">üìÇ ËºâÂÖ•‰∏ªÈ°å</button>
    <button class="btn" onclick="resetToDefault()">üîÑ ÈÇÑÂéüÈ†êË®≠</button>
    <button class="btn" onclick="exportTheme()">üì§ ÂåØÂá∫Ë®≠ÂÆö</button>
    <button class="btn" onclick="importTheme()">üì• ÂåØÂÖ•Ë®≠ÂÆö</button>
      </div>

  <div class="palette" id="palette"></div>
  
  <div class="status" id="status"></div>

  <script>
    // È†êË®≠È°èËâ≤ÈÖçÁΩÆÔºàÂæûcolor-palette-preview.htmlËß£ÊûêÔºâ
    const defaultColors = {
      'main-bg': { label: '‰∏ªËÉåÊôØËâ≤', color: '#ffffff', alpha: 1 },
      'sub-bg': { label: 'Ê¨°ËÉåÊôØËâ≤', color: '#f8f9fa', alpha: 1 },
      'card-bg': { label: 'Âç°ÁâáÂ∫ïËâ≤', color: '#007f7f', alpha: 0.7 },
      'card-gold': { label: 'È´ò‰∫ÆÂç°ÁâáÔºàÈáëËâ≤Ôºâ', color: '#FFD700', alpha: 1 },
      'progress-red': { label: 'ÈÄ≤Â∫¶Ê¢ùÔºàÁ¥ÖÔºâ', color: '#d9534f', alpha: 1 },
      'btn-blue': { label: '‰∏ªÊåâÈàïÔºàËóçÔºâ', color: '#007bff', alpha: 1 },
      'btn-cyan': { label: 'È´ò‰∫ÆÊåâÈàïÔºàÈùíÔºâ', color: '#17a2b8', alpha: 1 },
      'text-main': { label: '‰∏ªÊñáÂ≠óËâ≤', color: '#222222', alpha: 1 },
      'text-sub': { label: 'Ê¨°ÊñáÂ≠óËâ≤', color: '#333333', alpha: 1 },
      'text-black': { label: 'ÈªëËâ≤ÊñáÂ≠ó', color: '#000000', alpha: 1 },
      'cursor-dot': { label: 'Ëá™Ë®ÇÊ∏∏Ê®ôÂúìÈªû', color: '#ffffff', alpha: 0.18 },
      'cursor-shadow': { label: 'Ê∏∏Ê®ôÈô∞ÂΩ±', color: '#ffffff', alpha: 0.10 },
      'card-orange': { label: 'Âç°ÁâáÈ´ò‰∫ÆÔºàÊ©ôÔºâ', color: '#fd6900', alpha: 0.95 },
      'card-orange-light': { label: 'Âç°ÁâáÈ´ò‰∫ÆÔºàÊ©ôÔºåÊ∑°Ôºâ', color: '#fd6900', alpha: 0.85 },
      'card-orange-adv': { label: 'Âç°ÁâáÈ´ò‰∫ÆÔºàÊ©ôÔºåÈÄ≤ÈöéÔºâ', color: '#fd6900', alpha: 0.9 },
      'bg-dark': { label: '‰∏ªËÉåÊôØÔºàÊ∑±ÁÅ∞ÈªëÔºâ', color: '#131313', alpha: 1 },
      'bg-darkblue': { label: '‰∏ªËÉåÊôØÔºàÊ∑±ËóçÈªëÔºâ', color: '#02101c', alpha: 1 },
      'shadow-cyan': { label: 'Âç°ÁâáÈô∞ÂΩ±/ÊåâÈàïhover', color: '#00ffff', alpha: 0.5 },
      'border-cyan': { label: 'Âç°ÁâáÈÇäÊ°Ü/ÊåâÈàïactive', color: '#00ffff', alpha: 0.75 },
      'border-cyan-light': { label: 'Âç°ÁâáÈÇäÊ°ÜÊ∑°Ëâ≤', color: '#7fffff', alpha: 0.25 },
      'text-cyan': { label: 'Âç°ÁâáÊñáÂ≠ó/ÊåâÈàïÊñáÂ≠ó', color: '#7fffff', alpha: 0.75 },
      'text-main-card': { label: 'Âç°Áâá‰∏ªÊñáÂ≠ó', color: '#ffffff', alpha: 0.75 },
      'card-danmu-bg': { label: 'Âç°Áâá/ÂΩàÂπïÂ∫ïËâ≤', color: '#007f7f', alpha: 0.37 },
      'border-anim': { label: 'È´ò‰∫ÆÂãïÁï´ÈÇäÊ°Ü', color: '#03e9f4', alpha: 1 },
      'prize-shine': { label: 'prize-shine ÊñáÂ≠ó', color: '#db5c58', alpha: 1 },
      'progress-mask': { label: 'ÈÄ≤Â∫¶Ê¢ùËÉåÊôØ/ÈÅÆÁΩ©', color: '#000000', alpha: 0.5 },
      'progress-stripe': { label: 'ÈÄ≤Â∫¶Ê¢ùÊ¢ùÁ¥ã', color: '#ffffff', alpha: 0.15 },
      'bubble-bg': { label: 'Ê∞£Ê≥°Â∫ïËâ≤', color: '#7fffff', alpha: 0.25 },
      'bubble-text': { label: 'Ê∞£Ê≥°ÊñáÂ≠ó', color: '#7fffff', alpha: 0.75 },
      'music-btn': { label: 'Èü≥Ê®ÇÊåâÈàïÂ∫ïËâ≤', color: '#fd6900', alpha: 0.9 },
      // Êñ∞Â¢ûÂç°ÁâáÈñÉÁàçÈ´ò‰∫ÆËâ≤
      'shine-color': { label: 'Âç°ÁâáÈñÉÁàçÈ´ò‰∫ÆËâ≤', color: '#03e9f4', alpha: 1 },
      // Êñ∞Â¢ûËá™Ë®ÇÊ∏∏Ê®ôÂ∫ïËâ≤
      'cursor-bg': { label: 'Ê∏∏Ê®ôÂ∫ïËâ≤', color: '#ffffff', alpha: 0.18 },
      // Êñ∞Â¢ûËá™Ë®ÇÊ∏∏Ê®ôÈô∞ÂΩ±
      'cursor-shadow': { label: 'Ê∏∏Ê®ôÈô∞ÂΩ±', color: '#ffffff', alpha: 0.10 },
      // Êñ∞Â¢ûËÉåÊôØÊ®°Á≥äÊïàÊûú
      'bg-blur': { label: 'ËÉåÊôØÊ®°Á≥äÁ®ãÂ∫¶', color: '#000000', alpha: 8 },
      // Êñ∞Â¢ûËÉåÊôØËÆäÊöóÊïàÊûú
      'bg-darken': { label: 'ËÉåÊôØËÆäÊöóÁ®ãÂ∫¶', color: '#000000', alpha: 0.5 }
    };

    let currentColors = JSON.parse(JSON.stringify(defaultColors));

    // Ëß£ÊûêÈ°èËâ≤ÁÇ∫RGBÂíåAlpha
    function parseColor(colorStr) {
      if (colorStr.startsWith('#')) {
        const hex = colorStr.substring(1);
        const r = parseInt(hex.substr(0, 2), 16);
        const g = parseInt(hex.substr(2, 2), 16);
        const b = parseInt(hex.substr(4, 2), 16);
        return { r, g, b, alpha: 1 };
      } else if (colorStr.startsWith('rgba')) {
        const match = colorStr.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]+)?\)/);
        if (match) {
          return {
            r: parseInt(match[1]),
            g: parseInt(match[2]),
            b: parseInt(match[3]),
            alpha: match[4] ? parseFloat(match[4]) : 1
          };
        }
      }
      return { r: 0, g: 0, b: 0, alpha: 1 };
    }

    // ËΩâÊèõÁÇ∫RGBAÂ≠ó‰∏≤
    function toRGBA(r, g, b, alpha) {
      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    // ËΩâÊèõÁÇ∫HEXÂ≠ó‰∏≤
    function toHEX(r, g, b) {
      return '#' + [r, g, b].map(x => {
        const hex = x.toString(16);
        return hex.length === 1 ? '0' + hex : hex;
      }).join('');
    }

    // Âª∫Á´ãÈ°èËâ≤ÈÅ∏ÊìáÂô®
    function createColorPicker(key, config) {
      const item = document.createElement('div');
      item.className = 'color-item';
      
      // ÁâπÊÆäËôïÁêÜÔºöËÉåÊôØÊ®°Á≥äÂíåËÆäÊöóÊïàÊûú
      if (key === 'bg-blur' || key === 'bg-darken') {
        return createValuePicker(key, config);
      }
      
      // Â∑¶ÂÅ¥Â§ßËâ≤Â°ä
      const preview = document.createElement('div');
      preview.className = 'color-preview';
      // ÈÄèÊòéinput[type=color]Ë¶ÜËìã
      const colorPicker = document.createElement('input');
      colorPicker.type = 'color';
      colorPicker.value = config.color;
      preview.appendChild(colorPicker);
      // ‰øÆÊ≠£ÔºöÂêåÊôÇÁõ£ËÅΩoninputÂíåonchangeÔºåÁ¢∫‰øùÂêÑÁÄèË¶ΩÂô®ÈÉΩËÉΩÂêåÊ≠•
      function handleColorChange(e) {
        const val = e.target.value;
        // Ëß£ÊûêHEX
        const r = parseInt(val.substr(1,2),16);
        const g = parseInt(val.substr(3,2),16);
        const b = parseInt(val.substr(5,2),16);
        rSlider.value = r;
        gSlider.value = g;
        bSlider.value = b;
        config.color = val;
        updateDisplay();
      }
      colorPicker.oninput = handleColorChange;
      colorPicker.onchange = handleColorChange;

      // Âè≥ÂÅ¥Ë≥áË®ä
      const info = document.createElement('div');
      info.className = 'color-info';
      
      const label = document.createElement('div');
      label.className = 'color-label';
      // Âä†‰∏äÁ∑®Ëôü
      const itemIndex = Object.keys(currentColors).indexOf(key) + 1;
      label.textContent = `#${itemIndex.toString().padStart(2, '0')} ${config.label}`;
      
      const controls = document.createElement('div');
      controls.className = 'color-controls';
      
      // RGBAÊãâÊ¢ù
      const color = parseColor(config.color);
      const rSlider = document.createElement('input');
      rSlider.type = 'range'; rSlider.min = 0; rSlider.max = 255; rSlider.value = color.r;
      const gSlider = document.createElement('input');
      gSlider.type = 'range'; gSlider.min = 0; gSlider.max = 255; gSlider.value = color.g;
      const bSlider = document.createElement('input');
      bSlider.type = 'range'; bSlider.min = 0; bSlider.max = 255; bSlider.value = color.b;
      const aSlider = document.createElement('input');
      aSlider.type = 'range'; aSlider.min = 0; aSlider.max = 1; aSlider.step = 0.01; aSlider.value = config.alpha;

      // RGBAÊï∏ÂÄºÈ°ØÁ§∫
      const valueDisplay = document.createElement('div');
      valueDisplay.className = 'color-value';

      // ÊãâÊ¢ùÂçÄÂ°ä
      const rRow = document.createElement('div'); rRow.className = 'color-input';
      rRow.appendChild(Object.assign(document.createElement('label'), {textContent: 'R'}));
      rRow.appendChild(rSlider);
      rRow.appendChild(Object.assign(document.createElement('span'), {textContent: rSlider.value, style: 'width:28px;text-align:center;'}));
      const gRow = document.createElement('div'); gRow.className = 'color-input';
      gRow.appendChild(Object.assign(document.createElement('label'), {textContent: 'G'}));
      gRow.appendChild(gSlider);
      gRow.appendChild(Object.assign(document.createElement('span'), {textContent: gSlider.value, style: 'width:28px;text-align:center;'}));
      const bRow = document.createElement('div'); bRow.className = 'color-input';
      bRow.appendChild(Object.assign(document.createElement('label'), {textContent: 'B'}));
      bRow.appendChild(bSlider);
      bRow.appendChild(Object.assign(document.createElement('span'), {textContent: bSlider.value, style: 'width:28px;text-align:center;'}));
      const aRow = document.createElement('div'); aRow.className = 'color-input';
      aRow.appendChild(Object.assign(document.createElement('label'), {textContent: 'A'}));
      aRow.appendChild(aSlider);
      aRow.appendChild(Object.assign(document.createElement('span'), {textContent: aSlider.value, style: 'width:28px;text-align:center;'}));

      // ÈáçÁΩÆÊåâÈàï
      const resetBtn = document.createElement('button');
      resetBtn.className = 'reset-btn';
      resetBtn.textContent = 'ÈáçÁΩÆ';
      resetBtn.onclick = () => resetColor(key);

      // Êõ¥Êñ∞È°ØÁ§∫
      function updateDisplay() {
        // ÂêåÊ≠•ÊãâÊ¢ùËàáËâ≤Â°ä
        const r = parseInt(rSlider.value), g = parseInt(gSlider.value), b = parseInt(bSlider.value), a = parseFloat(aSlider.value);
        const rgba = toRGBA(r, g, b, a);
        preview.style.background = rgba;
        valueDisplay.textContent = rgba;
        currentColors[key] = {
          label: config.label,
          color: toHEX(r, g, b),
          alpha: a
        };
        rRow.querySelector('span').textContent = r;
        gRow.querySelector('span').textContent = g;
        bRow.querySelector('span').textContent = b;
        aRow.querySelector('span').textContent = a;
      }
      // ÊãâÊ¢ù‰∫ã‰ª∂
      [rSlider, gSlider, bSlider, aSlider].forEach(slider => slider.oninput = updateDisplay);

      // ÂàùÂßãÂåñÈ°ØÁ§∫
      updateDisplay();

      // ÁµÑË£ùDOM
      controls.appendChild(rRow);
      controls.appendChild(gRow);
      controls.appendChild(bRow);
      controls.appendChild(aRow);
      info.appendChild(label);
      info.appendChild(controls);
      info.appendChild(valueDisplay);
      info.appendChild(resetBtn);
      item.appendChild(preview);
      item.appendChild(info);
      return item;
    }

    // Âª∫Á´ãÊï∏ÂÄºÈÅ∏ÊìáÂô®ÔºàÁî®ÊñºËÉåÊôØÊ®°Á≥äÂíåËÆäÊöóÔºâ
    function createValuePicker(key, config) {
      const item = document.createElement('div');
      item.className = 'color-item';
      
      // Â∑¶ÂÅ¥È†êË¶ΩÂçÄ
      const preview = document.createElement('div');
      preview.className = 'color-preview';
      preview.style.background = 'linear-gradient(45deg, #333, #666)';
      preview.style.display = 'flex';
      preview.style.alignItems = 'center';
      preview.style.justifyContent = 'center';
      preview.style.color = '#fff';
      preview.style.fontSize = '12px';
      preview.style.fontWeight = 'bold';
      
      // Âè≥ÂÅ¥Ë≥áË®ä
      const info = document.createElement('div');
      info.className = 'color-info';
      
      const label = document.createElement('div');
      label.className = 'color-label';
      const itemIndex = Object.keys(currentColors).indexOf(key) + 1;
      label.textContent = `#${itemIndex.toString().padStart(2, '0')} ${config.label}`;
      
      const controls = document.createElement('div');
      controls.className = 'color-controls';
      
      // Êï∏ÂÄºÊãâÊ¢ù
      const valueSlider = document.createElement('input');
      valueSlider.type = 'range';
      if (key === 'bg-blur') {
        valueSlider.min = 0;
        valueSlider.max = 20;
        valueSlider.step = 0.5;
        valueSlider.value = parseFloat(config.alpha); // Áõ¥Êé•‰ΩøÁî®ÂÉèÁ¥†ÂÄº
      } else if (key === 'bg-darken') {
        valueSlider.min = 0;
        valueSlider.max = 1;
        valueSlider.step = 0.01;
        valueSlider.value = config.alpha;
      }
      
      // Êï∏ÂÄºÈ°ØÁ§∫
      const valueDisplay = document.createElement('div');
      valueDisplay.className = 'color-value';
      
      // Êõ¥Êñ∞È°ØÁ§∫
      function updateDisplay() {
        let displayValue;
        if (key === 'bg-blur') {
          displayValue = `${valueSlider.value}px`;
          preview.textContent = displayValue;
          // Ë®≠ÂÆöÂÖ®ÂüüËÆäÊï∏
          window.bgBlurValue = displayValue;
          // ÂÑ≤Â≠òÂà∞ localStorage
          localStorage.setItem('bgBlurValue', displayValue);
          // Ëß∏Áôº canvas ÈáçÊñ∞Áπ™Ë£Ω
          if (window.executeFrame) {
            console.log('Ëß∏ÁôºËÉåÊôØÊ®°Á≥äÊõ¥Êñ∞:', displayValue);
            // Âº∑Âà∂ÈáçÊñ∞Áπ™Ë£Ω
            setTimeout(() => {
              window.executeFrame();
            }, 10);
          }
        } else if (key === 'bg-darken') {
          displayValue = valueSlider.value;
          preview.textContent = `${Math.round(displayValue * 100)}%`;
          // Ë®≠ÂÆöÂÖ®ÂüüËÆäÊï∏
          window.bgDarkenValue = parseFloat(displayValue);
          // ÂÑ≤Â≠òÂà∞ localStorage
          localStorage.setItem('bgDarkenValue', displayValue);
          // Ëß∏Áôº canvas ÈáçÊñ∞Áπ™Ë£Ω
          if (window.executeFrame) {
            console.log('Ëß∏ÁôºËÉåÊôØËÆäÊöóÊõ¥Êñ∞:', displayValue);
            // Âº∑Âà∂ÈáçÊñ∞Áπ™Ë£Ω
            setTimeout(() => {
              window.executeFrame();
            }, 10);
          }
        }
        valueDisplay.textContent = displayValue;
        currentColors[key] = {
          label: config.label,
          color: config.color,
          alpha: key === 'bg-blur' ? parseFloat(valueSlider.value) : parseFloat(valueSlider.value)
        };
      }
      
      valueSlider.oninput = updateDisplay;
      
      // ÈáçÁΩÆÊåâÈàï
      const resetBtn = document.createElement('button');
      resetBtn.className = 'reset-btn';
      resetBtn.textContent = 'ÈáçÁΩÆ';
      resetBtn.onclick = () => resetColor(key);
      
      // ÁµÑË£ùDOM
      controls.appendChild(valueSlider);
      info.appendChild(label);
      info.appendChild(controls);
      info.appendChild(valueDisplay);
      info.appendChild(resetBtn);
      item.appendChild(preview);
      item.appendChild(info);
      
      // ÂàùÂßãÂåñÈ°ØÁ§∫
      updateDisplay();
      
      return item;
    }

    // ÈáçÁΩÆÂñÆ‰∏ÄÈ°èËâ≤
    function resetColor(key) {
      const defaultColor = defaultColors[key];
      currentColors[key] = JSON.parse(JSON.stringify(defaultColor));
      loadTheme(); // ÈáçÊñ∞ËºâÂÖ•È°ØÁ§∫
      showStatus('Â∑≤ÈáçÁΩÆ ' + defaultColor.label);
    }

    // È°ØÁ§∫ÁãÄÊÖãË®äÊÅØ
    function showStatus(message) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.style.opacity = '1';
      setTimeout(() => {
        status.style.opacity = '0';
      }, 2000);
    }

    // ÂÑ≤Â≠ò‰∏ªÈ°å
    function saveTheme() {
      localStorage.setItem('lotteryTheme', JSON.stringify(currentColors));
      showStatus('‰∏ªÈ°åÂ∑≤ÂÑ≤Â≠òÔºÅ');
    }

    // ËºâÂÖ•‰∏ªÈ°å
    function loadTheme() {
      const saved = localStorage.getItem('lotteryTheme');
      if (saved) {
        // Âêà‰Ωµ defaultColorsÔºå‰øùË≠âÊâÄÊúâ key ÈÉΩÂ≠òÂú®
        const loaded = JSON.parse(saved);
        currentColors = {};
        Object.keys(defaultColors).forEach(key => {
          if (loaded[key]) {
            // Ëã•Êúâ label ËÆäÂãï‰πüÁî®Êñ∞Áâà
            currentColors[key] = {
              label: defaultColors[key].label,
              color: loaded[key].color,
              alpha: loaded[key].alpha
            };
          } else {
            currentColors[key] = JSON.parse(JSON.stringify(defaultColors[key]));
          }
        });
      } else {
        // Â¶ÇÊûúÊ≤íÊúâÂÑ≤Â≠òÁöÑ‰∏ªÈ°åÔºåÂòóË©¶Âæû CSS ËÆäÊï∏ËÆÄÂèñÁï∂ÂâçË®≠ÂÆö
        currentColors = JSON.parse(JSON.stringify(defaultColors));
        
        try {
          const computedStyle = getComputedStyle(document.documentElement);
          Object.keys(defaultColors).forEach(key => {
            const cssVar = computedStyle.getPropertyValue(`--${key}`);
            if (cssVar && cssVar.trim() !== '') {
              // Ëß£Êûê rgba ÂÄº
              const rgbaMatch = cssVar.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]+)?\)/);
              if (rgbaMatch) {
                const r = parseInt(rgbaMatch[1]);
                const g = parseInt(rgbaMatch[2]);
                const b = parseInt(rgbaMatch[3]);
                const alpha = rgbaMatch[4] ? parseFloat(rgbaMatch[4]) : 1;
                
                // ËΩâÊèõÁÇ∫ HEX
                const hex = '#' + [r, g, b].map(x => {
                  const hex = x.toString(16);
                  return hex.length === 1 ? '0' + hex : hex;
                }).join('');
                
                currentColors[key] = {
                  label: defaultColors[key].label,
                  color: hex,
                  alpha: alpha
                };
                console.log(`Âæû CSS ËÆäÊï∏ËÆÄÂèñ ${key}:`, hex, alpha);
              }
            }
          });
        } catch (error) {
          console.log('ËÆÄÂèñ CSS ËÆäÊï∏Â§±ÊïóÔºå‰ΩøÁî®È†êË®≠ÂÄº');
        }
      }
      
      // Âæû localStorage ËÆÄÂèñËÉåÊôØÂèÉÊï∏Ë®≠ÂÆö
      const bgBlurValue = localStorage.getItem('bgBlurValue');
      const bgDarkenValue = localStorage.getItem('bgDarkenValue');
      
      if (bgBlurValue) {
        // ÊèêÂèñÊï∏ÂÄºÔºàÂéªÊéâ 'px'Ôºâ
        const blurNum = parseFloat(bgBlurValue);
        currentColors['bg-blur'].alpha = blurNum;
        console.log('ËºâÂÖ•ËÉåÊôØÊ®°Á≥äË®≠ÂÆö:', blurNum);
      }
      
      if (bgDarkenValue !== null) {
        const darkenNum = parseFloat(bgDarkenValue);
        currentColors['bg-darken'].alpha = darkenNum;
        console.log('ËºâÂÖ•ËÉåÊôØËÆäÊöóË®≠ÂÆö:', darkenNum);
      }
      
      renderPalette();
      showStatus('‰∏ªÈ°åÂ∑≤ËºâÂÖ•ÔºÅ');
    }

    // ÈÇÑÂéüÈ†êË®≠
    function resetToDefault() {
      currentColors = JSON.parse(JSON.stringify(defaultColors));
      
      // Ê∏ÖÈô§ËÉåÊôØÂèÉÊï∏Ë®≠ÂÆö
      localStorage.removeItem('bgBlurValue');
      localStorage.removeItem('bgDarkenValue');
      
      renderPalette();
      showStatus('Â∑≤ÈÇÑÂéüÈ†êË®≠Ë®≠ÂÆöÔºÅ');
    }

    // ÂåØÂá∫Ë®≠ÂÆö
    function exportTheme() {
      const dataStr = JSON.stringify(currentColors, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'lottery-theme.json';
      link.click();
      URL.revokeObjectURL(url);
      showStatus('Ë®≠ÂÆöÂ∑≤ÂåØÂá∫ÔºÅ');
    }

    // ÂåØÂÖ•Ë®≠ÂÆö
    function importTheme() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            try {
              const imported = JSON.parse(e.target.result);
              // Âêà‰Ωµ defaultColorsÔºå‰øùË≠âÊâÄÊúâ key ÈÉΩÂ≠òÂú®
              currentColors = {};
              Object.keys(defaultColors).forEach(key => {
                if (imported[key]) {
                  currentColors[key] = {
                    label: defaultColors[key].label,
                    color: imported[key].color,
                    alpha: imported[key].alpha
                  };
                  // ÁâπÊÆäËôïÁêÜËÉåÊôØÊïàÊûú
                  if (key === 'bg-blur') {
                    const blurValue = `${imported[key].alpha}px`;
                    document.documentElement.style.setProperty('--bg-blur', blurValue);
                  } else if (key === 'bg-darken') {
                    document.documentElement.style.setProperty('--bg-darken', imported[key].alpha);
                  }
                } else {
                  currentColors[key] = JSON.parse(JSON.stringify(defaultColors[key]));
                }
              });
              renderPalette();
              showStatus('Ë®≠ÂÆöÂ∑≤ÂåØÂÖ•ÔºÅ');
            } catch (error) {
              showStatus('ÂåØÂÖ•Â§±ÊïóÔºöÊ™îÊ°àÊ†ºÂºèÈåØË™§');
            }
          };
          reader.readAsText(file);
        }
      };
      input.click();
    }

    // Ê∏≤ÊüìË™øËâ≤Áõ§
    function renderPalette() {
      const palette = document.getElementById('palette');
      palette.innerHTML = '';
      
      Object.entries(currentColors).forEach(([key, config]) => {
        const picker = createColorPicker(key, config);
        palette.appendChild(picker);
      });
    }

    // ÂàùÂßãÂåñÊôÇÂÖàËºâÂÖ•Áï∂ÂâçË®≠ÂÆö
    loadTheme();
    
    // ÂàùÂßãÂåñ
    renderPalette();

    // Ê®ôÈ°åÊªæÂãïÈö±Ëóè
    window.addEventListener('scroll', function() {
      const h1 = document.getElementById('main-title');
      if (window.scrollY > 40) {
        h1.classList.add('h1-hidden');
      } else {
        h1.classList.remove('h1-hidden');
      }
    });
  </script>
</body>
</html> 